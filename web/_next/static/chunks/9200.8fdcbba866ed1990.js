(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9200],{69200:function(e,t,n){"use strict";n.r(t),n.d(t,{AutoBounds:function(){return w},BaseGeoJSON:function(){return C},MapStatePreserver:function(){return L},default:function(){return I},defaultDeConfig:function(){return O}});var o=n(85893),r=n(67294),l=n(39153),i=n(32342),a=n(84867),s=n(5715),c=n(26467),u=n(60990),f=n(93454),d=n(97182),p=n(96788),h=n(45243),g=n.n(h);n(53183);var y=n(11163),m=n(20577),v=n(32604);let x=g().divIcon({className:"custom-location-marker",html:'<div class="location-marker-inner"></div>',iconSize:[16,16],iconAnchor:[8,16]});var b=()=>{let[e,t]=(0,r.useState)(null),n=(0,l.Sx)();return((0,r.useEffect)(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{let{latitude:n,longitude:o}=e.coords;t([n,o])},e=>{console.error("Kh\xf4ng lấy được vị tr\xed:",e)})},[n]),e)?(0,o.jsx)(m.J,{position:e,icon:x,children:(0,o.jsx)(v.G,{children:"Vị tr\xed hiện tại của bạn"})}):null};let{BaseLayer:j}=i.LayersControl,C=e=>{let{data:t,style:n={color:"#3388ff",weight:2,opacity:1,fillOpacity:.2},interactive:r=!1,onEachFeature:l}=e;return(0,o.jsx)(a.Q,{data:t,style:n,interactive:r,onEachFeature:l})},w=e=>{let{geojsonData:t,markers:n=[],fitOnce:o=!0}=e,i=(0,l.Sx)(),a=r.useRef(!1);return(0,r.useEffect)(()=>{if(o&&a.current||!t||0===t.length)return;let e=g().latLngBounds([]);t.forEach(t=>{if(t&&t.features){let n=g().geoJSON(t);e.extend(n.getBounds())}}),n&&n.length>0&&n.forEach(t=>{t.position&&e.extend(t.position)}),e.isValid()&&(i.fitBounds(e,{padding:[50,50]}),a.current=!0)},[i,t,n,o]),null},L=()=>{let e=(0,l.Sx)(),[t]=r.useState({zoom:e.getZoom(),center:e.getCenter()}),n=r.useRef({zoom:t.zoom,center:t.center,isMoving:!1});return r.useEffect(()=>{let t=()=>{n.current={zoom:e.getZoom(),center:e.getCenter(),isMoving:!1}},o=()=>{n.current.isMoving=!0},r=()=>{n.current.isMoving=!1,t()};return e.on("zoomend",t),e.on("movestart",o),e.on("moveend",r),()=>{e.off("zoomend",t),e.off("movestart",o),e.off("moveend",r)}},[e]),r.useEffect(()=>{if(!n.current.isMoving){let{zoom:t,center:o}=n.current;e.getZoom()===t&&e.getCenter().equals(o)||e.setView(o,t,{animate:!1})}}),null},O={bingKey:"AuhiCJHlGzhg93IqUH_oCpl_-ZUrIE6SPftlyGYUvr9Amx5nzA-WqGcPquyFZl4L",mapCenter:[20.65,106.1],mapZoom:10,maxBounds:[[20,104.8],[21.2,106.85]]};var I=e=>{let{children:t,config:n,loading:l}=e,h={...O,...n},[m,v]=(0,r.useState)(null),[x,C]=(0,r.useState)(null),[w,I]=(0,r.useState)(!0),{basePath:S}=(0,y.useRouter)(),[B]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat(S,"/geojson/phuongxa-hye.geojson")),t=await e.json();B&&C(t)}catch(e){console.error("Kh\xf4ng thể tải phuongxa-hye.geojson:",e)}};(async()=>{I(!0);try{let e=await fetch("".concat(S,"/geojson/hye.geojson")),t=await e.json();v(t)}catch(e){console.error("Kh\xf4ng thể tải boundary geojson:",e)}finally{I(!1)}})(),e()},[S]),(0,o.jsx)(u.Z,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:(0,o.jsxs)(f.Z,{elevation:3,sx:{flex:1,position:"relative",overflow:"hidden",borderRadius:"8px"},children:[(w||l)&&(0,o.jsxs)(u.Z,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"rgba(255,255,255,0.7)",zIndex:1500},children:[(0,o.jsx)(d.Z,{color:"error"}),(0,o.jsx)(p.Z,{variant:"body2",sx:{ml:2},children:"Đang tải dữ liệu bản đồ..."})]}),(0,o.jsxs)(s.h,{center:h.mapCenter,zoom:h.mapZoom,minZoom:10,maxBounds:h.maxBounds,maxBoundsViscosity:1,style:{height:"100%",width:"100%"},attributionControl:!1,children:[(0,o.jsxs)(i.LayersControl,{position:"bottomright",children:[(0,o.jsx)(j,{name:"Bản đồ h\xe0nh ch\xednh",children:(0,o.jsx)(c.I,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"})}),(0,o.jsx)(j,{checked:!0,name:"Bản đồ vệ tinh",children:(0,o.jsx)(c.I,{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles \xa9 Esri"})}),(0,o.jsx)(j,{name:"Bản đồ nền x\xe1m",children:(0,o.jsx)(c.I,{url:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png",attribution:"\xa9 CartoDB"})})]}),m&&(0,o.jsx)(a.Q,{data:m,style:{color:"#ffffffff",weight:2,fill:!1,fillOpacity:.25},interactive:!1}),x&&(0,o.jsx)(a.Q,{data:x,style:{color:"#ffffff83",weight:1.2,dashArray:"3, 3"},interactive:!0,onEachFeature:(e,t)=>{if(t.on({mouseover:e=>{let t=e.target;t.setStyle({weight:2,opacity:1,dashArray:"2, 2",color:"#0088ff"}),g().Browser.ie||g().Browser.opera||g().Browser.edge||t.bringToFront()},mouseout:e=>{e.target.setStyle({color:"#ffffff83",weight:1.2,opacity:.8,fillOpacity:.01,dashArray:"3, 3"})}}),e.properties&&e.properties.ten_xa){let n=(e=>{try{if(e.includes("\xc3"))return decodeURIComponent(escape(e));return e}catch(t){return console.error("Lỗi giải m\xe3 t\xean x\xe3:",t),e}})(e.properties.ten_xa),o=t.getBounds().getCenter();t.bindTooltip(n,{permanent:!0,direction:"center",className:"phuong-xa-tooltip map-label",opacity:1,offset:[0,0]}),t.on("tooltipopen",function(e){try{let t=e.tooltip;t&&"function"==typeof t.setLatLng&&t.setLatLng(o)}catch(e){console.error("Lỗi khi định vị tooltip:",e)}})}}}),t,(0,o.jsx)(b,{}),(0,o.jsx)(L,{})]})]})})}},53183:function(){},71469:function(e,t,n){"use strict";function o(e,t,n){let{opacity:o,zIndex:r}=t;null!=o&&o!==n.opacity&&e.setOpacity(o),null!=r&&r!==n.zIndex&&e.setZIndex(r)}n.d(t,{I:function(){return o}})},32342:function(e,t,n){"use strict";n.d(t,{LayersControl:function(){return f}});var o=n(27999),r=n(1410),l=n(77418),i=n(99534),a=n(45243),s=n(67294);let c=(0,o.I)(function({children:e,...t},n){let l=new a.Control.Layers(void 0,void 0,t);return(0,o.O)(l,(0,r.sj)(n,{layersControl:l}))},function(e,t,n){t.collapsed!==n.collapsed&&(!0===t.collapsed?e.collapse():e.expand())}),u=(0,l.y)(c),f=(0,i.RA)(u);function d(e){return function(t){let n=(0,r.mE)(),o=(0,s.useRef)(t),[l,i]=(0,s.useState)(null),{layersControl:a,map:c}=n,u=(0,s.useCallback)(t=>{null!=a&&(o.current.checked&&c.addLayer(t),e(a,t,o.current.name),i(t))},[a,c]),f=(0,s.useCallback)(e=>{a?.removeLayer(e),i(null)},[a]),d=(0,s.useMemo)(()=>(0,r.sj)(n,{layerContainer:{addLayer:u,removeLayer:f}}),[n,u,f]);return(0,s.useEffect)(()=>{null!==l&&o.current!==t&&(!0===t.checked&&(null==o.current.checked||!1===o.current.checked)?c.addLayer(l):!0===o.current.checked&&(null==t.checked||!1===t.checked)&&c.removeLayer(l),o.current=t)}),t.children?s.createElement(r.UO,{value:d},t.children):null}}f.BaseLayer=d(function(e,t,n){e.addBaseLayer(t,n)}),f.Overlay=d(function(e,t,n){e.addOverlay(t,n)})},5715:function(e,t,n){"use strict";n.d(t,{h:function(){return a}});var o=n(1410),r=n(45243),l=n(67294);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}let a=(0,l.forwardRef)(function({bounds:e,boundsOptions:t,center:n,children:a,className:s,id:c,placeholder:u,style:f,whenReady:d,zoom:p,...h},g){let[y]=(0,l.useState)({className:s,id:c,style:f}),[m,v]=(0,l.useState)(null);(0,l.useImperativeHandle)(g,()=>m?.map??null,[m]);let x=(0,l.useCallback)(l=>{if(null!==l&&null===m){let i=new r.Map(l,h);null!=n&&null!=p?i.setView(n,p):null!=e&&i.fitBounds(e,t),null!=d&&i.whenReady(d),v((0,o.Hb)(i))}},[]);(0,l.useEffect)(()=>()=>{m?.map.remove()},[m]);let b=m?l.createElement(o.UO,{value:m},a):u??null;return l.createElement("div",i({},y,{ref:x}),b)})},20577:function(e,t,n){"use strict";n.d(t,{J:function(){return a}});var o=n(74579),r=n(27999),l=n(1410),i=n(45243);let a=(0,o.dW)(function({position:e,...t},n){let o=new i.Marker(e,t);return(0,r.O)(o,(0,l.sj)(n,{overlayContainer:o}))},function(e,t,n){t.position!==n.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==n.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==n.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())})},32604:function(e,t,n){"use strict";n.d(t,{G:function(){return a}});var o=n(74579),r=n(27999),l=n(45243),i=n(67294);let a=(0,o.SO)(function(e,t){let n=new l.Popup(e,t.overlayContainer);return(0,r.O)(n,t)},function(e,t,{position:n},o){(0,i.useEffect)(function(){let{instance:r}=e;function l(e){e.popup===r&&(r.update(),o(!0))}function i(e){e.popup===r&&o(!1)}return t.map.on({popupopen:l,popupclose:i}),null==t.overlayContainer?(null!=n&&r.setLatLng(n),r.openOn(t.map)):t.overlayContainer.bindPopup(r),function(){t.map.off({popupopen:l,popupclose:i}),t.overlayContainer?.unbindPopup(),t.map.removeLayer(r)}},[e,t,o,n])})},26467:function(e,t,n){"use strict";n.d(t,{I:function(){return s}});var o=n(74579),r=n(81802),l=n(27999),i=n(71469),a=n(45243);let s=(0,o.Lf)(function({url:e,...t},n){let o=new a.TileLayer(e,(0,r.q)(t,n));return(0,l.O)(o,n)},function(e,t,n){(0,i.I)(e,t,n);let{url:o}=t;null!=o&&o!==n.url&&e.setUrl(o)})}}]);