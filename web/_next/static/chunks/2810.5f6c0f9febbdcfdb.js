"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2810],{68431:function(e,t,n){var s=n(85893);n(67294);var l=n(88196),a=n(92365),i=n(40110),r=n(44723),o=n(96788),c=n(96727),d=n(51015),h=n(97182);t.Z=e=>{let{open:t,onClose:n,onConfirm:u,title:x,itemName:m,itemType:p,loading:g,error:j,success:Z,warningMessage:y}=e;return(0,s.jsxs)(l.Z,{open:t,onClose:g?void 0:n,children:[(0,s.jsx)(a.Z,{children:x}),(0,s.jsxs)(i.Z,{children:[j&&(0,s.jsx)(r.Z,{severity:"error",sx:{mb:2},children:j}),Z&&(0,s.jsxs)(r.Z,{severity:"success",sx:{mb:2},children:["X\xf3a ",p.toLowerCase()," th\xe0nh c\xf4ng!"]}),(0,s.jsxs)(o.Z,{children:["Bạn c\xf3 chắc chắn muốn x\xf3a ",p.toLowerCase()," ",(0,s.jsx)("strong",{children:m}),"?"]}),(0,s.jsx)(o.Z,{color:"error",variant:"body2",sx:{mt:1},children:y||"Lưu \xfd: H\xe0nh động n\xe0y kh\xf4ng thể ho\xe0n t\xe1c."})]}),(0,s.jsxs)(c.Z,{children:[(0,s.jsx)(d.Z,{onClick:n,disabled:g,children:"Hủy"}),(0,s.jsx)(d.Z,{variant:"contained",color:"error",onClick:u,disabled:g||Z,startIcon:g&&(0,s.jsx)(h.Z,{size:16,color:"inherit"}),children:g?"Đang x\xf3a...":"X\xe1c nhận x\xf3a"})]})]})}},53565:function(e,t,n){var s=n(85893),l=n(67294),a=n(93454),i=n(84166),r=n(88196),o=n(92365),c=n(52857),d=n(40110),h=n(61193),u=n.n(h),x=n(95639),m=n(46312);let p=e=>{let t=(0,l.useRef)(null);return(0,s.jsx)(u(),{handle:"#draggable-dialog-title",nodeRef:t,cancel:'[class*="MuiDialogContent-root"]',children:(0,s.jsx)(a.Z,{ref:t,...e})})};t.Z=e=>{let{children:t}=e,[n,a]=(0,l.useState)(null),[h,u]=(0,l.useState)(null),[g,j]=(0,l.useState)(!1),[Z,y]=(0,l.useState)({width:1200,height:700}),b=()=>{a(null),u(null),j(!1),y({width:1200,height:700})};return(0,s.jsxs)(i.Z,{children:[t((e,t)=>{a(e),u(t),j(!0)},b),(0,s.jsx)(r.Z,{open:g,onClose:b,PaperComponent:p,"aria-labelledby":"draggable-dialog-title",PaperProps:{sx:{width:"auto",height:"auto",maxWidth:"100vw",maxHeight:"100vh","&::-webkit-scrollbar":{display:"none"},msOverflowStyle:"none",scrollbarWidth:"none"}},children:(0,s.jsxs)(m.e,{size:Z,onResizeStop:(e,t,n,s)=>{y({width:Z.width+s.width,height:Z.height+s.height})},minWidth:400,minHeight:300,maxWidth:"100vw",maxHeight:"100vh",enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},children:[(0,s.jsxs)(o.Z,{style:{position:"sticky",left:0,right:0,top:0,cursor:"move",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"#007fff",color:"#fff",paddingTop:5,paddingBottom:5,zIndex:9999999},id:"draggable-dialog-title",children:[h,(0,s.jsx)(c.Z,{onClick:b,children:(0,s.jsx)(x.Z,{sx:{color:"red"}})})]}),(0,s.jsx)(d.Z,{sx:{p:"1.25rem","&.MuiDialogContent-root":{padding:"1.25rem"}},children:n})]})})]})}},76598:function(e,t,n){n.d(t,{Z:function(){return a}});var s=n(67294),l=n(21565);let a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pauseGlobalLoading:!0},[t,n]=(0,s.useState)(!1),{pauseGlobalLoading:a,resumeGlobalLoading:i}=(0,l.r)();return(0,s.useEffect)(()=>(e.pauseGlobalLoading&&a(),()=>{e.pauseGlobalLoading&&i()}),[e.pauseGlobalLoading,a,i]),{isSubmitting:t,submitForm:async e=>{n(!0);try{return await e()}finally{n(!1)}}}}},2810:function(e,t,n){n.r(t),n.d(t,{default:function(){return X}});var s=n(85893),l=n(67294),a=n(96788),i=n(81873),r=n(60762),o=n(60990),c=n(84166),d=n(44723),h=n(40492),u=n(95611),x=n(21038),m=n(52857),p=n(56912),g=n(39203),j=n(88148),Z=n(24772),y=n(38855),b=n(83947),f=n(89090),v=n(53565),S=n(94094),C=n(77355),w=n(38444),A=n(68963),E=n(55201),k=n(86240),T=n(68573),D=n(93454),z=n(29437),P=n(96727),L=n(51015),K=n(97182),I=n(64577),R=n(13754),B=n(76598),H=n(15243);let W=e=>{let{data:t,setPostSuccess:n,closeDialogs:i}=e,[r,o]=(0,l.useState)({}),[x,m]=(0,l.useState)(!1),[g,j]=(0,l.useState)(null),{isSubmitting:Z,submitForm:y}=(0,B.Z)(),{success:b,error:f}=(0,R.l)(),[v,E]=(0,l.useState)({id:(null==t?void 0:t.id)||0,name:(null==t?void 0:t.name)||null,path:(null==t?void 0:t.path)||null,pathKey:(null==t?void 0:t.pathKey)||null,module:(null==t?void 0:t.module)||null,permitAccess:(null==t?void 0:t.permitAccess)||!1}),k=e=>t=>{let n="checkbox"===t.target.type?t.target.checked:t.target.value;r[e]&&o({...r,[e]:void 0}),E({...v,module:"tai-nguyen-nuoc",[e]:n})},W=()=>{let e={};return v.name||(e.name="T\xean trang l\xe0 bắt buộc"),v.path?v.path.startsWith("/")||(e.path="Đường dẫn phải bắt đầu bằng /"):e.path="Đường dẫn l\xe0 bắt buộc",v.pathKey||(e.pathKey="Từ kh\xf3a l\xe0 bắt buộc"),o(e),0===Object.keys(e).length},_=async e=>{e.preventDefault(),j(null),m(!1),W()&&await y(async()=>{try{let e={id:v.id,name:v.name||"",path:v.path||"",url:v.path||"",module:v.module||"tai-nguyen-nuoc",pathKey:v.pathKey||"",permitAccess:v.permitAccess||!1,icon:"",order:0},t=!1;if(v.id&&0!==v.id?(t=await I.authService.updateDashboard(v.id,e,!1))&&b(H.S.DASHBOARD.UPDATE_SUCCESS):(t=await I.authService.createDashboard(e,!1))&&b(H.S.DASHBOARD.CREATE_SUCCESS),t)return m(!0),setTimeout(()=>{"function"==typeof n&&n(!0),i()},1500),!0;{let e="Kh\xf4ng thể lưu trang. Vui l\xf2ng thử lại sau.";return j(e),f(e),!1}}catch(t){console.error(t);let e=t.message||"Đ\xe3 xảy ra lỗi khi lưu trang";return j(e),f(e),!1}})};return(0,s.jsxs)("form",{onSubmit:_,children:[g&&(0,s.jsx)(d.Z,{severity:"error",sx:{mb:3},children:g}),x&&(0,s.jsx)(d.Z,{severity:"success",sx:{mb:3},children:v.id&&v.id>0?H.S.DASHBOARD.UPDATE_SUCCESS:H.S.DASHBOARD.CREATE_SUCCESS}),(0,s.jsxs)(T.ZP,{container:!0,spacing:3,children:[(0,s.jsx)(T.ZP,{item:!0,xs:12,children:(0,s.jsx)(h.Z,{size:"small",fullWidth:!0,label:"T\xean trang",placeholder:"Nhập t\xean trang",value:(null==v?void 0:v.name)||"",onChange:k("name"),autoComplete:"off",required:!0,error:!!r.name,helperText:r.name,InputProps:{startAdornment:(0,s.jsx)(u.Z,{position:"start",children:(0,s.jsx)(S.Z,{fontSize:"small",color:"action"})})}})}),(0,s.jsx)(T.ZP,{item:!0,xs:12,children:(0,s.jsx)(h.Z,{size:"small",fullWidth:!0,label:"Đường dẫn",placeholder:"/duong-dan-url",value:(null==v?void 0:v.path)||"",onChange:k("path"),autoComplete:"off",required:!0,error:!!r.path,helperText:r.path,InputProps:{startAdornment:(0,s.jsx)(u.Z,{position:"start",children:(0,s.jsx)(C.Z,{fontSize:"small",color:"action"})})}})}),(0,s.jsx)(T.ZP,{item:!0,xs:12,children:(0,s.jsx)(h.Z,{size:"small",fullWidth:!0,label:"Từ kh\xf3a",placeholder:"tu-khoa-duong-dan",value:(null==v?void 0:v.pathKey)||"",onChange:k("pathKey"),autoComplete:"off",required:!0,error:!!r.pathKey,helperText:r.pathKey||"Từ kh\xf3a d\xf9ng để ph\xe2n quyền v\xe0 định danh trang"})}),(0,s.jsx)(T.ZP,{item:!0,xs:12,children:(0,s.jsxs)(D.Z,{variant:"outlined",sx:{p:2,bgcolor:e=>"dark"===e.palette.mode?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.02)"},children:[(0,s.jsxs)(c.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,s.jsx)(a.Z,{variant:"body2",children:"Cho ph\xe9p truy cập"}),(0,s.jsx)(z.Z,{checked:!!(null==v?void 0:v.permitAccess),onChange:k("permitAccess"),color:"primary"})]}),(0,s.jsx)(a.Z,{variant:"caption",color:"text.secondary",children:"Khi được bật, trang sẽ hiển thị trong menu v\xe0 c\xf3 thể truy cập được"})]})})]}),(0,s.jsx)(p.Z,{sx:{my:3}}),(0,s.jsxs)(P.Z,{sx:{p:0,justifyContent:"space-between"},children:[(0,s.jsx)(L.Z,{variant:"outlined",onClick:i,disabled:Z,startIcon:(0,s.jsx)(w.Z,{}),children:"Hủy"}),(0,s.jsx)(L.Z,{type:"submit",variant:"contained",disabled:Z||x,startIcon:Z?(0,s.jsx)(K.Z,{size:16,color:"inherit"}):(0,s.jsx)(A.Z,{}),children:Z?"Đang lưu...":"Lưu"})]})]})};var _=e=>{let{data:t,isEdit:n,setPostSuccess:l,children:a}=e,i=n?"Chỉnh sửa trang truy cập":"Th\xeam trang truy cập mới";return(0,s.jsx)(v.Z,{children:(e,r)=>(0,s.jsx)(o.Z,{children:a?(0,s.jsx)(o.Z,{onClick:()=>e((0,s.jsx)(W,{data:t,setPostSuccess:l,isEdit:n,closeDialogs:r}),i),children:a}):n?(0,s.jsx)(x.Z,{title:"Chỉnh sửa trang",children:(0,s.jsx)(m.Z,{className:"tableActionBtn",onClick:()=>e((0,s.jsx)(W,{data:t,setPostSuccess:l,isEdit:n,closeDialogs:r}),i),children:(0,s.jsx)(E.Z,{fontSize:"small"})})}):(0,s.jsx)(x.Z,{title:"Th\xeam trang mới",children:(0,s.jsx)(m.Z,{className:"tableActionBtn",onClick:()=>e((0,s.jsx)(W,{data:t,setPostSuccess:l,isEdit:n,closeDialogs:r}),i),children:(0,s.jsx)(k.Z,{})})})})})},N=n(39892),O=n(11163),U=n(59701),G=n(68431),X=()=>{let[e,t]=(0,l.useState)([]),[n,v]=(0,l.useState)(!1),[S,C]=(0,l.useState)(""),[w,A]=(0,l.useState)(!1),[E,k]=(0,l.useState)(!1),[T,D]=(0,l.useState)(null),[z,P]=(0,l.useState)(!1),[L,K]=(0,l.useState)(null),B=(0,O.useRouter)(),{getPermissionMap:W}=(0,U.Q)(),[X,q]=(0,l.useState)(null),{success:M,error:Q}=(0,R.l)(),F=e.filter(e=>{var t,n;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(S.toLowerCase()))||(null===(n=e.path)||void 0===n?void 0:n.toLowerCase().includes(S.toLowerCase()))});(0,l.useEffect)(()=>{(async()=>{q(await W(B.asPath))})()},[W,B.asPath]);let V=()=>{v(e=>!e)},J=e=>{K(e),A(!0)},Y=()=>{A(!1),D(null),P(!1),setTimeout(()=>{K(null)},200)},$=async()=>{if(L){k(!0),D(null);try{if(await I.authService.deleteDashboard(L.id,!1))P(!0),M(H.S.DASHBOARD.DELETE_SUCCESS),setTimeout(()=>{Y(),V()},1500);else{let e="Kh\xf4ng thể x\xf3a trang n\xe0y";D(e),Q(e)}}catch(t){let e=t.message||"Đ\xe3 xảy ra lỗi khi x\xf3a trang";D(e),Q(e)}finally{k(!1)}}};return(0,l.useEffect)(()=>{(async()=>{try{let e=await I.authService.getDashboards();t(e)}catch(e){console.error("Error fetching dashboards:",e),t([])}finally{}})()},[n]),(0,s.jsxs)(r.Z,{children:[(0,s.jsx)(o.Z,{sx:{p:3,borderBottom:e=>"1px solid ".concat(e.palette.divider)},children:(0,s.jsxs)(c.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,s.jsx)(Z.Z,{color:"primary"}),(0,s.jsx)(a.Z,{variant:"h6",children:"Quản l\xfd trang truy cập"}),(0,s.jsx)(i.Z,{size:"small",label:"".concat(e.length," trang"),color:"primary",sx:{ml:1}})]})}),z&&(0,s.jsx)(d.Z,{severity:"success",sx:{m:3,mt:2},onClose:()=>P(!1),children:"X\xf3a trang th\xe0nh c\xf4ng!"}),T&&(0,s.jsx)(d.Z,{severity:"error",sx:{m:3,mt:2},onClose:()=>D(null),children:T}),(0,s.jsxs)(o.Z,{sx:{p:3,pb:2,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2},children:[(0,s.jsx)(h.Z,{size:"small",placeholder:"T\xecm kiếm trang...",value:S,onChange:e=>C(e.target.value),sx:{minWidth:{xs:"100%",sm:300}},InputProps:{startAdornment:(0,s.jsx)(u.Z,{position:"start",children:(0,s.jsx)(y.Z,{fontSize:"small"})}),autoComplete:"off"}}),(0,s.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsx)(x.Z,{title:"L\xe0m mới",children:(0,s.jsx)(m.Z,{color:"primary",onClick:()=>{V(),M("Đ\xe3 l\xe0m mới dữ liệu")},size:"small",children:(0,s.jsx)(b.Z,{})})}),(0,s.jsx)(p.Z,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),(null==X?void 0:X.CREATE)&&(0,s.jsx)(_,{data:null,setPostSuccess:V,isEdit:!1})]})]}),(0,s.jsx)(p.Z,{}),(0,s.jsx)(N.Z,{columns:[{id:"name",label:"T\xean trang web",elm:e=>(0,s.jsx)(a.Z,{variant:"body1",fontWeight:500,children:e.name})},{id:"pathKey",label:"key",elm:e=>(0,s.jsx)(a.Z,{variant:"body2",sx:{color:"primary.main"},children:e.pathKey})},{id:"permitAccess",label:"Trạng th\xe1i",elm:e=>(0,s.jsx)(i.Z,{icon:e.permitAccess?(0,s.jsx)(g.Z,{fontSize:"small"}):(0,s.jsx)(j.Z,{fontSize:"small"}),label:e.permitAccess?"Được truy cập":"Giới hạn truy cập",color:e.permitAccess?"success":"error",size:"small",variant:"outlined"})},{id:"actions",label:"#",pinned:"right"}],rows:F,pagination:!0,actions:e=>(0,s.jsxs)(o.Z,{className:"group_btn",children:[(null==X?void 0:X.EDIT)&&(0,s.jsx)(_,{data:e,setPostSuccess:V,isEdit:!0}),(null==X?void 0:X.DELETE)&&(0,s.jsx)(x.Z,{title:"X\xf3a",children:(0,s.jsx)(m.Z,{size:"small",color:"error",className:"tableActionBtn deleteBtn",onClick:()=>J(e),children:(0,s.jsx)(f.Z,{fontSize:"small"})})})]})}),(0,s.jsx)(G.Z,{open:w,onClose:Y,onConfirm:$,title:"X\xe1c nhận x\xf3a trang",itemName:(null==L?void 0:L.name)||"",itemType:"trang",loading:E,error:T,success:z})]})}}}]);