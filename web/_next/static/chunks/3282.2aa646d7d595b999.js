"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3282],{58585:function(e,n,a){var i=a(85893);a(67294);var t=a(52857),o=a(95639);n.Z=e=>{let{onClick:n,size:a="small",sx:l={},ariaLabel:r="close"}=e;return(0,i.jsx)(t.Z,{"aria-label":r,onClick:n,size:a,sx:{ml:2,backgroundColor:"whitesmoke","&:hover":{backgroundColor:"#e0e0e0"},...l},children:(0,i.jsx)(o.Z,{})})}},55536:function(e,n,a){var i=a(67294),t=a(39153),o=a(29291),l=a(92893);n.Z=e=>{let n=(0,t.Sx)(),a=(0,i.useRef)(null),r=(0,i.useRef)(new Map),s=(0,i.useRef)(null),u=(0,i.useRef)(null),d="#3cff00ff",h=(0,i.useCallback)(e=>{e.setStyle({weight:4,opacity:1,color:d}),L.Browser.ie||L.Browser.opera||L.Browser.edge||e.bringToFront()},[d]),c=(0,o.Y)(),m=e.data||c.filteredDoanDeList,g=c.layerLabelState,p=c.focusedId,{setInfoDrawerOpen:v,setSelectedItem:y,selectedItem:D,infoDrawerOpen:C,setClickedCoordinates:x}=c;return(0,i.useEffect)(()=>{if(!n.getPane("dikePane")){let e=n.createPane("dikePane");e.style.zIndex="650",e.style.pointerEvents="auto"}},[n,r]),(0,i.useEffect)(()=>{if(a.current&&n.removeLayer(a.current),!m||0===m.length)return;let e=L.featureGroup();return a.current=e,r.current.clear(),m.forEach(n=>{let a=n.toaDo;if(!a||!a.geometry||!a.geometry.coordinates)return;let i=n.color||(0,l.dI)(n.maLoaiCongTrinh,c.legendData),t=L.geoJSON(a,{style:{color:i,weight:2,opacity:.8},pane:"dikePane",interactive:!0,onEachFeature:(e,a)=>{var t,o,l;a instanceof L.Path&&(n.id&&(r.current.set(n.id,a),a._originalStyle={weight:a.options.weight,opacity:a.options.opacity,color:a.options.color}),a.options.interactive=!0,a.on("mouseover",function(){D&&"id"in D&&n.id===D.id&&C||h(a)}),a.on("mouseout",function(){var e;if(D&&"id"in D&&n.id===D.id&&C)return;a.setStyle({weight:2,opacity:.8,color:i});let t=a.getTooltip();null==t||null===(e=t.getElement())||void 0===e||e.classList.remove("highlight-tooltip")})),a.on("click",e=>{y(n),v(!0);let{lat:a,lng:i}=e.latlng;x({lat:a,lng:i}),console.log("Dike clicked:",n.tenDoan||n.id,"at coordinates:",{lat:a,lng:i}),L.DomEvent.stopPropagation(e)});let s=null==(t=n.tenTuyenDe)?"Chưa x\xe1c định":String(t).replace(/"/g,"&quot;").replace(/'/g,"&#39;");n.maLoaiCongTrinh&&g[n.maLoaiCongTrinh]&&(n.tenDoan&&"chưa x\xe1c định"!==n.tenDoan.toLocaleLowerCase()||(null===(o=n.tenDoan)||void 0===o?void 0:o.trim())!=="-")&&a.bindTooltip(null!==(l=n.tenDoan)&&void 0!==l?l:"",{permanent:!0,className:"map-label ke-label",opacity:1}),s&&"chưa x\xe1c định"!==s.toLocaleLowerCase()&&a.bindTooltip(s,{permanent:!0,className:"map-label tuyen-de-label",opacity:1})}});e.addLayer(t)}),e.addTo(n),e.bringToFront(),()=>{a.current&&n.removeLayer(a.current)}},[m,n,c.legendData,g,v,y,C,D,r,h,x]),(0,i.useEffect)(()=>{if(s.current){let e=s.current,n=e._originalStyle||{weight:2,opacity:.8,color:"#3388ff"};e.setStyle(n),s.current=null}if(D&&C&&"id"in D&&D.id){let e=r.current.get(D.id);e&&(h(e),s.current=e)}},[D,C,d,r,s,h]),(0,i.useEffect)(()=>{if(u.current){try{n.removeLayer(u.current)}catch(e){}u.current=null}if(!p)return;let e=r.current.get(p);if(e)try{if(e.getLatLng){let a=e.getLatLng();n.flyTo(a,Math.max(n.getZoom(),15),{duration:.75});let i=L.circleMarker(a,{radius:10,color:"#ff9800",weight:3,opacity:.9,fillColor:"#ff9800",fillOpacity:.15,pane:"dikePane"});i.addTo(n),i.bringToFront(),u.current=i;return}if(e.getBounds){let a=e.getBounds();if(a&&a.isValid&&a.isValid()){if(n.fitBounds(a,{padding:[40,40]}),e.toGeoJSON){let a=e.toGeoJSON(),i=L.geoJSON(a,{style:{color:"#ff9800",weight:6,opacity:.95},pane:"dikePane"});i.addTo(n),i.bringToFront&&i.bringToFront(),u.current=i}return}}}catch(e){console.error("Kh\xf4ng thể zoom tới đoạn đ\xea đ\xe3 chọn:",e)}},[p,n]),(0,i.useEffect)(()=>()=>{if(u.current){try{n.removeLayer(u.current)}catch(e){}u.current=null}},[n]),null}},22567:function(e,n,a){var i=a(85893),t=a(67294),o=a(53839),l=a(88196),r=a(92365),s=a(96788),u=a(40110),d=a(6897),h=a(50333),c=a(40492),m=a(60990),g=a(51015),p=a(56912),v=a(96727),y=a(18708),D=a(58585);let C=e=>e?(e=(e=e.replace(/[đĐ]/g,e=>"đ"===e?"d":"D")).normalize("NFD").replace(/[\u0300-\u036f]/g,"")).toLowerCase().trim().replace(/\s+/g,"-"):"";n.Z=e=>{var n,a,x,T,b,f,j,Z,S,w,k,M,I,B,z,N,P;let{open:O,onClose:W,onSaveComplete:R,editId:G}=e,[E,V]=(0,t.useState)([]),[F,J]=(0,t.useState)([]),[_,K]=(0,t.useState)([]),[H,q]=(0,t.useState)(!1),[A,Y]=(0,t.useState)(!1),[Q,U]=(0,t.useState)({tenTuyenDe:"",loaiCongTrinhId:"",maTuyen:"",moTa:""}),[X,$]=(0,t.useState)({id:"",tuyenDeId:"",tenDoan:"",viTriTu:0,viTriDen:0,diaDanh:"",capDeId:"",chieuDai:0,toaDo:"",tenTuyenDe:"",maTuyen:"",loaiCongTrinh:"",maLoaiCongTrinh:"",capDe:"",matCat:{caoTrinhMatDe:0,caoTrinhThietKe:0,chenhCao:0,beRongMatDe:0,maiDePhiaSong:0,maiDePhiaDong:0,chieuCaoDe:0,chieuRongCoTL:0,chieuRongCoHL:0,danhGia:""},nangCap:{chieuDaiPhanCap:0,chieuDaiChuaPhanCap:0,doCaoDu:!1,doMatCatTK:!1,chieuRongMatCat:0,canNangCap_CaoTrinh:0,canNangCap_MatDe:0,ghiChu:""},deBoi:{caoTrinhMat:0,heSoMai:0,hienTrangMatDe:"",dienTichDuocBaoVe:0,danSoDuocBaoVe:0,danhGia:""}}),ee=async()=>{try{let e=await y.I.getAllTuyenDe({pageNumber:1,pageSize:1e3});V(e.items||[])}catch(e){console.error("Lỗi khi tải danh s\xe1ch tuyến đ\xea:",e)}},en=async()=>{try{let e=await y.I.getAllCapDe(1,100);J(e.items||[])}catch(e){console.error("Lỗi khi tải danh s\xe1ch cấp đ\xea:",e)}},ea=async()=>{try{let e=await y.I.getAllLoaiTuyenDe(1,100);K(e.items||[])}catch(e){console.error("Lỗi khi tải danh s\xe1ch loại tuyến đ\xea:",e)}},ei=async e=>{try{q(!0);let n=await y.I.getDoanDeById(e);n&&(n.toaDo&&"object"==typeof n.toaDo&&(n.toaDo=JSON.stringify(n.toaDo,null,2)),$(n))}catch(e){console.error("Lỗi khi tải dữ liệu đoạn đ\xea:",e)}finally{q(!1)}},et=()=>{$({id:"",tuyenDeId:"",tenDoan:"",viTriTu:0,viTriDen:0,diaDanh:"",capDeId:"",chieuDai:0,toaDo:"",tenTuyenDe:"",maTuyen:"",loaiCongTrinh:"",maLoaiCongTrinh:"",capDe:"",matCat:{caoTrinhMatDe:0,caoTrinhThietKe:0,chenhCao:0,beRongMatDe:0,maiDePhiaSong:0,maiDePhiaDong:0,chieuCaoDe:0,chieuRongCoTL:0,chieuRongCoHL:0,danhGia:""},nangCap:{chieuDaiPhanCap:0,chieuDaiChuaPhanCap:0,doCaoDu:!1,doMatCatTK:!1,chieuRongMatCat:0,canNangCap_CaoTrinh:0,canNangCap_MatDe:0,ghiChu:""},deBoi:{caoTrinhMat:0,heSoMai:0,hienTrangMatDe:"",dienTichDuocBaoVe:0,danSoDuocBaoVe:0,danhGia:""}})},eo=e=>{let{name:n,value:a}=e.target;if("tenTuyenDe"===n){let e=C(a),i=_.find(e=>e.id===Q.loaiCongTrinhId),t=C((null==i?void 0:i.tenLoai)||""),o=t?"".concat(e,"-").concat(t):e;U({...Q,[n]:a,maTuyen:o})}else U({...Q,[n]:a})},el=async()=>{if(!Q.tenTuyenDe.trim()){alert("Vui l\xf2ng nhập t\xean tuyến đ\xea");return}if(!Q.loaiCongTrinhId){alert("Vui l\xf2ng chọn loại tuyến đ\xea");return}try{q(!0),await y.I.saveTuyenDe(Q)&&(await ee(),Y(!1),U({tenTuyenDe:"",loaiCongTrinhId:"",maTuyen:"",moTa:""}),alert("Th\xeam tuyến đ\xea mới th\xe0nh c\xf4ng!"))}catch(e){console.error("Lỗi khi lưu tuyến đ\xea:",e),alert("C\xf3 lỗi xảy ra khi lưu tuyến đ\xea")}finally{q(!1)}},er=e=>{let{name:n,value:a}=e.target;if("toaDo"===n){try{if(!a.trim()){$({...X,[n]:a});return}let e=JSON.parse(a),i=JSON.stringify(e,null,2);$({...X,[n]:i})}catch(e){$({...X,[n]:a})}return}if(n.startsWith("matCat.")){let e=n.split(".")[1];$({...X,matCat:{...X.matCat||{},[e]:"danhGia"===e?a:Number(a)}})}else if(n.startsWith("deBoi.")){let e=n.split(".")[1];$({...X,deBoi:{...X.deBoi||{},[e]:["hienTrangMatDe","danhGia"].includes(e)?a:Number(a)}})}else $({...X,[n]:a})};(0,t.useEffect)(()=>{O&&(async()=>{let e=[];0===E.length&&e.push(ee()),0===F.length&&e.push(en()),0===_.length&&e.push(ea()),await Promise.all(e),G?ei(G):et()})()},[O,G,E.length,F.length,_.length]),(0,t.useEffect)(()=>{(async()=>{try{await Promise.all([ee(),en(),ea()])}catch(e){console.error("Lỗi preload data:",e)}})()},[]);let es=e=>{if(!e)return!0;try{let n="string"==typeof e?JSON.parse(e):e;return n&&("Feature"===n.type||"LineString"===n.type||"Polygon"===n.type||"Point"===n.type)&&(n.geometry||n.coordinates)}catch(e){return!1}},eu=async e=>{if(e.preventDefault(),X.toaDo&&!es(X.toaDo)){alert("Dữ liệu tọa độ kh\xf4ng hợp lệ. Vui l\xf2ng kiểm tra định dạng GeoJSON.");return}q(!0);try{let e={...X,viTriTu:X.viTriTu?Number(X.viTriTu):void 0,viTriDen:X.viTriDen?Number(X.viTriDen):void 0,chieuDai:X.chieuDai?Number(X.chieuDai):void 0,toaDo:X.toaDo?"string"==typeof X.toaDo?JSON.parse(X.toaDo):X.toaDo:void 0};await y.I.saveDoanDe(e)&&(R&&R(!0),W(),$({capDeId:"",tuyenDeId:"",tenDoan:"",toaDo:"",viTriTu:0,viTriDen:0,diaDanh:"",chieuDai:0,matCat:{caoTrinhMatDe:0,caoTrinhThietKe:0,chenhCao:0,beRongMatDe:0,maiDePhiaSong:0,maiDePhiaDong:0,chieuCaoDe:0,chieuRongCoTL:0,chieuRongCoHL:0,danhGia:""},deBoi:{caoTrinhMat:0,heSoMai:0,hienTrangMatDe:"",dienTichDuocBaoVe:0,danSoDuocBaoVe:0,danhGia:""}}))}catch(e){console.error("Lỗi khi lưu đoạn đ\xea:",e)}finally{q(!1)}},[ed,eh]=(0,t.useState)(null),[ec,em]=(0,t.useState)([]),[eg,ep]=(0,t.useState)(null),[ev,ey]=(0,t.useState)(!1),[eD,eC]=(0,t.useState)(0),ex=async e=>{var n;let a=null===(n=e.target.files)||void 0===n?void 0:n[0];if(!a)return;eh(a),ep(null),em([]);let i=new FileReader;i.onload=async e=>{try{var n;let a=JSON.parse(null===(n=e.target)||void 0===n?void 0:n.result);if(!a.type||"FeatureCollection"!==a.type||!a.features){ep("File kh\xf4ng phải l\xe0 GeoJSON FeatureCollection hợp lệ");return}let i=a.features.map(e=>{var n,a,i,t,o,l,r,s;let u;let d=(null===(a=e.properties)||void 0===a?void 0:null===(n=a.Ten_tuyen)||void 0===n?void 0:n.trim())||"",h=(null===(t=e.properties)||void 0===t?void 0:null===(i=t.Loai_de)||void 0===i?void 0:i.trim())||"",c=(null===(l=e.properties)||void 0===l?void 0:null===(o=l.Cap_de)||void 0===o?void 0:o.trim())||"",m=c?"Cấp ".concat(c):"",g=E.find(e=>e.tenTuyenDe&&e.tenTuyenDe.trim().toLowerCase()===d.toLowerCase()&&e.loaiDe&&e.loaiDe.trim().toLowerCase()===h.toLowerCase());g||(g=E.find(e=>{var n;return(null===(n=e.tenTuyenDe)||void 0===n?void 0:n.trim().toLowerCase())==="chưa x\xe1c định"}));let p=F.find(e=>(e.tenCap||"").trim().toLowerCase()===m.toLowerCase());return p||(p=F.find(e=>"chưa ph\xe2n cấp"===(e.tenCap||"").trim().toLowerCase())),e.geometry&&e.geometry.type&&e.geometry.coordinates&&(u={type:"Feature",geometry:{type:e.geometry.type,coordinates:e.geometry.coordinates}}),{tenDoan:"".concat(d," - ").concat(h),tuyenDeId:(null==g?void 0:g.id)||"",capDeId:(null==p?void 0:p.id)||"",chieuDai:parseFloat(null===(r=e.properties)||void 0===r?void 0:r.Chdai_km)||0,toaDo:u,diaDanh:(null===(s=e.properties)||void 0===s?void 0:s.Thuoc_huyen)||""}});em(i)}catch(e){ep("Kh\xf4ng thể đọc file GeoJSON. Kiểm tra định dạng file.")}},i.readAsText(a)},eT=async()=>{if(0===ec.length){ep("Kh\xf4ng c\xf3 dữ liệu để lưu");return}ey(!0),ep(null),eC(0);try{let e=ec.length,n=0,a=[];for(let i of ec)try{await y.I.saveDoanDe({...i,chieuDai:i.chieuDai?Number(i.chieuDai):void 0,toaDo:i.toaDo}),n++,eC(Math.floor(n/e*100))}catch(e){a.push(i.tenDoan||"Kh\xf4ng t\xean")}0===a.length?ep(null):ep("C\xf3 ".concat(a.length," đoạn đ\xea kh\xf4ng lưu được: ").concat(a.join(", "))),n>0&&(R&&R(!0),setTimeout(()=>{em([]),eh(null)},2e3))}catch(e){ep("Lỗi khi lưu dữ liệu. Vui l\xf2ng thử lại.")}finally{ey(!1)}};return(0,i.jsxs)(l.Z,{open:O,onClose:W,maxWidth:"lg",fullWidth:!0,children:[(0,i.jsxs)(r.Z,{children:[(0,i.jsx)(s.Z,{variant:"h5",component:"div",sx:{fontWeight:"bold"},children:G?"Chỉnh sửa đoạn đ\xea":"Th\xeam mới đoạn đ\xea"}),(0,i.jsx)(D.Z,{onClick:W,size:"small",ariaLabel:"close"})]}),(0,i.jsxs)(u.Z,{dividers:!0,sx:{padding:3},children:[(0,i.jsxs)("form",{onSubmit:eu,children:[(0,i.jsxs)(d.Z,{fullWidth:!0,margin:"dense",sx:{mb:1.5},children:[(0,i.jsx)(s.Z,{variant:"subtitle2",sx:{mb:.5},children:"Cấp đ\xea"}),(0,i.jsx)(h.Z,{options:F,getOptionLabel:e=>(null==e?void 0:e.tenCap)||"",value:F.find(e=>e.id===X.capDeId)||null,onChange:(e,n)=>{$({...X,capDeId:n?n.id:""})},isOptionEqualToValue:(e,n)=>e.id===n.id,renderInput:e=>(0,i.jsx)(c.Z,{...e,label:"Chọn cấp đ\xea",size:"small"}),clearOnEscape:!0})]}),(0,i.jsxs)(d.Z,{fullWidth:!0,margin:"dense",sx:{mb:1.5},children:[(0,i.jsx)(s.Z,{variant:"subtitle2",sx:{mb:.5},children:"Tuyến đ\xea"}),(0,i.jsxs)(m.Z,{sx:{display:"flex",gap:1,alignItems:"center"},children:[(0,i.jsx)(h.Z,{options:E,getOptionLabel:e=>"".concat((null==e?void 0:e.tenTuyenDe)||""," ").concat((null==e?void 0:e.loaiDe)?"(".concat(null==e?void 0:e.loaiDe,")"):""),value:E.find(e=>e.id===X.tuyenDeId)||null,onChange:(e,n)=>{$({...X,tuyenDeId:n?n.id:"",loaiCongTrinh:(null==n?void 0:n.loaiDe)||""})},isOptionEqualToValue:(e,n)=>e.id===n.id,renderInput:e=>(0,i.jsx)(c.Z,{...e,label:"Chọn tuyến đ\xea",size:"small"}),sx:{flex:1},clearOnEscape:!0}),(0,i.jsx)(g.Z,{variant:"outlined",size:"small",startIcon:(0,i.jsx)(o.Z,{}),onClick:()=>Y(!0),sx:{minWidth:"auto",whiteSpace:"nowrap"},children:"Th\xeam mới"})]})]}),(0,i.jsx)(c.Z,{fullWidth:!0,margin:"dense",name:"tenDoan",label:"T\xean đoạn đ\xea",value:X.tenDoan||"",onChange:er,size:"small",sx:{mb:1.5}}),(0,i.jsx)(c.Z,{fullWidth:!0,margin:"dense",name:"toaDo",label:"Dữ liệu GeoJSON",value:X.toaDo||"",onChange:er,multiline:!0,rows:10,size:"small",sx:{mb:1.5},helperText:"Nhập dữ liệu tọa độ theo định dạng GeoJSON Feature với type: Feature, geometry: {type: LineString, coordinates: [[longitude, latitude], ...]}",placeholder:'{"type":"Feature","geometry":{"type":"LineString","coordinates":[[106.10, 20.62], [106.11, 20.63]]}}'}),(0,i.jsxs)(m.Z,{sx:{display:"flex",gap:1.5,mb:1.5},children:[(0,i.jsx)(c.Z,{type:"number",name:"viTriTu",label:"Từ Km",value:X.viTriTu||"",onChange:er,size:"small",fullWidth:!0}),(0,i.jsx)(c.Z,{type:"number",name:"viTriDen",label:"Đến Km",value:X.viTriDen||"",onChange:er,size:"small",fullWidth:!0})]}),(0,i.jsx)(c.Z,{fullWidth:!0,margin:"dense",name:"diaDanh",label:"Địa danh",value:X.diaDanh||"",onChange:er,size:"small",sx:{mb:1.5}}),(0,i.jsx)(c.Z,{fullWidth:!0,margin:"dense",type:"number",name:"chieuDai",label:"Chiều d\xe0i",value:X.chieuDai||"",onChange:er,size:"small",sx:{mb:1.5}}),(0,i.jsxs)(m.Z,{sx:{mb:1.5},children:[(0,i.jsx)(s.Z,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1},children:"Th\xf4ng tin mặt cắt"}),(0,i.jsx)(p.Z,{sx:{mb:2}}),(0,i.jsxs)(m.Z,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:1},children:[(0,i.jsx)(c.Z,{type:"number",name:"matCat.caoTrinhMatDe",label:"Cao tr\xecnh mặt đ\xea",value:(null===(n=X.matCat)||void 0===n?void 0:n.caoTrinhMatDe)||"",onChange:er,size:"small",margin:"dense"}),(0,i.jsx)(c.Z,{type:"number",name:"matCat.caoTrinhThietKe",label:"Cao tr\xecnh thiết kế",value:(null===(a=X.matCat)||void 0===a?void 0:a.caoTrinhThietKe)||"",onChange:er,size:"small",margin:"dense"}),(0,i.jsx)(c.Z,{type:"number",name:"matCat.chenhCao",label:"Ch\xeanh cao",value:(null===(x=X.matCat)||void 0===x?void 0:x.chenhCao)||"",onChange:er,size:"small",margin:"dense"}),(0,i.jsx)(c.Z,{type:"number",name:"matCat.beRongMatDe",label:"Bề rộng mặt đ\xea",value:(null===(T=X.matCat)||void 0===T?void 0:T.beRongMatDe)||"",onChange:er,size:"small",margin:"dense"}),(0,i.jsx)(c.Z,{type:"number",name:"matCat.maiDePhiaSong",label:"M\xe1i đ\xea ph\xeda s\xf4ng",value:(null===(b=X.matCat)||void 0===b?void 0:b.maiDePhiaSong)||"",onChange:er,size:"small",margin:"dense"}),(0,i.jsx)(c.Z,{type:"number",name:"matCat.maiDePhiaDong",label:"M\xe1i đ\xea ph\xeda đồng",value:(null===(f=X.matCat)||void 0===f?void 0:f.maiDePhiaDong)||"",onChange:er,size:"small",margin:"dense"}),(0,i.jsx)(c.Z,{type:"number",name:"matCat.chieuCaoDe",label:"Chiều cao đ\xea",value:(null===(j=X.matCat)||void 0===j?void 0:j.chieuCaoDe)||"",onChange:er,size:"small",margin:"dense"}),(0,i.jsx)(c.Z,{type:"number",name:"matCat.chieuRongCoTL",label:"Chiều rộng cơ TL",value:(null===(Z=X.matCat)||void 0===Z?void 0:Z.chieuRongCoTL)||"",onChange:er,size:"small",margin:"dense"}),(0,i.jsx)(c.Z,{type:"number",name:"matCat.chieuRongCoHL",label:"Chiều rộng cơ HL",value:(null===(S=X.matCat)||void 0===S?void 0:S.chieuRongCoHL)||"",onChange:er,size:"small",margin:"dense"})]}),(0,i.jsx)(m.Z,{sx:{mt:1},children:(0,i.jsx)(c.Z,{name:"matCat.danhGia",label:"Đ\xe1nh gi\xe1",value:(null===(w=X.matCat)||void 0===w?void 0:w.danhGia)||"",onChange:er,multiline:!0,rows:3,fullWidth:!0,size:"small",margin:"dense"})})]}),(null===(k=X.loaiCongTrinh)||void 0===k?void 0:k.toLocaleLowerCase())==="de_boi"?(0,i.jsxs)(m.Z,{sx:{mb:1.5},children:[(0,i.jsx)(s.Z,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1},children:"Th\xf4ng tin đ\xea bối"}),(0,i.jsx)(p.Z,{sx:{mb:2}}),(0,i.jsxs)(m.Z,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:1},children:[(0,i.jsx)(c.Z,{type:"number",name:"deBoi.caoTrinhMat",label:"Cao tr\xecnh mặt",value:(null===(M=X.deBoi)||void 0===M?void 0:M.caoTrinhMat)||"",onChange:er,size:"small",margin:"dense"}),(0,i.jsx)(c.Z,{type:"number",name:"deBoi.heSoMai",label:"Hệ số m\xe1i",value:(null===(I=X.deBoi)||void 0===I?void 0:I.heSoMai)||"",onChange:er,size:"small",margin:"dense"}),(0,i.jsx)(c.Z,{type:"number",name:"deBoi.dienTichDuocBaoVe",label:"Diện t\xedch được bảo vệ",value:(null===(B=X.deBoi)||void 0===B?void 0:B.dienTichDuocBaoVe)||"",onChange:er,size:"small",margin:"dense"}),(0,i.jsx)(c.Z,{type:"number",name:"deBoi.danSoDuocBaoVe",label:"D\xe2n số được bảo vệ",value:(null===(z=X.deBoi)||void 0===z?void 0:z.danSoDuocBaoVe)||"",onChange:er,size:"small",margin:"dense"})]}),(0,i.jsx)(m.Z,{sx:{mt:1},children:(0,i.jsx)(c.Z,{name:"deBoi.hienTrangMatDe",label:"Hiện trạng mặt đ\xea",value:(null===(N=X.deBoi)||void 0===N?void 0:N.hienTrangMatDe)||"",onChange:er,multiline:!0,rows:3,fullWidth:!0,size:"small",margin:"dense"})}),(0,i.jsx)(m.Z,{sx:{mt:1},children:(0,i.jsx)(c.Z,{name:"deBoi.danhGia",label:"Đ\xe1nh gi\xe1",value:(null===(P=X.deBoi)||void 0===P?void 0:P.danhGia)||"",onChange:er,multiline:!0,rows:3,fullWidth:!0,size:"small",margin:"dense"})})]}):null]}),(0,i.jsxs)(m.Z,{sx:{mb:3,mt:1,p:2,border:"1px dashed #ccc",borderRadius:2},children:[(0,i.jsx)(s.Z,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1},children:"Import file GeoJSON đoạn đ\xea"}),(0,i.jsxs)(m.Z,{sx:{display:"flex",gap:2,alignItems:"center",mb:2},children:[(0,i.jsxs)(g.Z,{variant:"contained",component:"label",disabled:ev,children:["Chọn file GeoJSON",(0,i.jsx)("input",{type:"file",accept:".geojson,application/json",hidden:!0,onChange:ex})]}),ed&&(0,i.jsx)(s.Z,{variant:"body2",children:ed.name})]}),eg&&(0,i.jsx)(s.Z,{color:"error",sx:{mb:1},children:eg}),ev&&(0,i.jsx)(m.Z,{sx:{display:"flex",alignItems:"center",mb:2},children:(0,i.jsxs)(s.Z,{variant:"body2",color:"text.secondary",sx:{mr:2},children:["Đang lưu... ",eD,"%"]})}),ec.length>0&&(0,i.jsxs)(m.Z,{sx:{mb:2},children:[(0,i.jsxs)(s.Z,{variant:"subtitle2",children:["Preview dữ liệu (",ec.length," đoạn đ\xea):"]}),(0,i.jsx)(m.Z,{sx:{maxHeight:200,overflow:"auto",border:"1px solid #eee",mt:1},children:ec.map((e,n)=>(0,i.jsxs)(m.Z,{sx:{p:1,borderBottom:"1px solid #eee"},children:[(0,i.jsxs)(s.Z,{variant:"body2",children:[(0,i.jsx)("b",{children:e.tenDoan})," | Tuyến đ\xea: ",e.tuyenDeId," | Cấp đ\xea: ",e.capDeId," | Chiều d\xe0i:"," ",e.chieuDai,"km"]}),(0,i.jsxs)(s.Z,{variant:"caption",children:["Địa danh: ",e.diaDanh]})]},n))}),(0,i.jsxs)(g.Z,{onClick:eT,variant:"contained",color:"primary",disabled:ev,sx:{mt:2},children:["Lưu tất cả (",ec.length,")"]})]})]})]}),(0,i.jsxs)(l.Z,{open:A,onClose:()=>Y(!1),maxWidth:"sm",fullWidth:!0,children:[(0,i.jsxs)(r.Z,{children:[(0,i.jsx)(s.Z,{variant:"h6",component:"div",sx:{fontWeight:"bold"},children:"Th\xeam tuyến đ\xea mới"}),(0,i.jsx)(D.Z,{onClick:()=>Y(!1),size:"small",sx:{ml:2},ariaLabel:"close"})]}),(0,i.jsxs)(u.Z,{dividers:!0,children:[(0,i.jsx)(c.Z,{fullWidth:!0,margin:"dense",name:"tenTuyenDe",label:"T\xean tuyến đ\xea *",value:Q.tenTuyenDe,onChange:eo,size:"small",sx:{mb:1.5}}),(0,i.jsxs)(d.Z,{fullWidth:!0,margin:"dense",sx:{mb:1.5},children:[(0,i.jsx)(s.Z,{variant:"subtitle2",sx:{mb:.5},children:"Loại tuyến đ\xea *"}),(()=>{let e=_.find(e=>"DE"===e.maLoai),n=null==e?void 0:e.id,a=_.filter(e=>e.idParrent===n);return(0,i.jsx)(h.Z,{options:a,getOptionLabel:e=>(null==e?void 0:e.tenLoai)||"",value:_.find(e=>e.id===Q.loaiCongTrinhId)||null,onChange:(e,n)=>{let a=C((null==n?void 0:n.tenLoai)||""),i=C(Q.tenTuyenDe),t=n?"".concat(i,"-").concat(a):C(Q.tenTuyenDe);U({...Q,loaiCongTrinhId:(null==n?void 0:n.id)||"",maTuyen:t})},isOptionEqualToValue:(e,n)=>e.id===n.id,renderInput:e=>(0,i.jsx)(c.Z,{...e,label:"Chọn loại tuyến đ\xea",size:"small"}),clearOnEscape:!0})})()]}),(0,i.jsx)(c.Z,{fullWidth:!0,margin:"dense",name:"maTuyen",label:"M\xe3 tuyến",value:Q.maTuyen,onChange:eo,size:"small",sx:{mb:1.5},helperText:"M\xe3 tuyến được tạo tự động từ t\xean v\xe0 loại tuyến đ\xea, c\xf3 thể chỉnh sửa"}),(0,i.jsx)(c.Z,{fullWidth:!0,margin:"dense",name:"moTa",label:"M\xf4 tả",value:Q.moTa,onChange:eo,multiline:!0,rows:3,size:"small"})]}),(0,i.jsxs)(v.Z,{children:[(0,i.jsx)(g.Z,{onClick:el,variant:"outlined",color:"primary",disabled:H,children:H?"Đang lưu...":"Lưu"}),(0,i.jsx)(g.Z,{onClick:()=>Y(!1),variant:"outlined",color:"error",disabled:H,children:"Hủy"})]})]}),(0,i.jsxs)(v.Z,{children:[(0,i.jsx)(g.Z,{onClick:e=>eu(e),variant:"outlined",color:"primary",disabled:H,children:H?"Đang lưu...":"Lưu"}),(0,i.jsx)(g.Z,{onClick:W,variant:"outlined",color:"error",disabled:H,children:"Hủy"})]})]})}}}]);