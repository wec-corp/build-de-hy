"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4631],{44631:function(n,t,e){e.r(t);var r=e(85893),u=e(67294),o=e(5152),i=e.n(o),c=e(39153),l=e(84867),a=e(60990),f=e(97182),s=e(96788),d=e(45243),p=e.n(d);let h=i()(()=>Promise.all([e.e(4028),e.e(9200)]).then(e.bind(e,69200)),{loadableGenerated:{webpack:()=>[69200]},ssr:!1,loading:()=>(0,r.jsxs)(a.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:[(0,r.jsx)(f.Z,{}),(0,r.jsx)(s.Z,{variant:"body1",sx:{ml:2},children:"Đang tải bản đồ..."})]})});t.default=n=>{let{doanDeList:t,loading:e=!1,selectedId:o=null,onSelectFeature:i}=n,d=(0,u.useMemo)(()=>{if(!t||0===t.length)return null;console.log("DeBoiLayerMap - Tổng số đoạn đ\xea:",t.length);let n=t.filter(n=>"DE_BOI"===n.maLoaiCongTrinh);console.log("DeBoiLayerMap - Số đoạn đ\xea bối:",n.length),console.log("DeBoiLayerMap - Số đoạn đ\xea bối c\xf3 tọa độ:",n.filter(n=>n.toaDo).length);let e=t.filter(n=>n.toaDo&&"DE_BOI"===n.maLoaiCongTrinh).map(n=>{try{let t="string"==typeof n.toaDo?JSON.parse(n.toaDo):n.toaDo;if(console.log("Đọc toaDo của đoạn đ\xea bối ".concat(n.tenDoan||n.id,":"),typeof t,t?"c\xf3 dữ liệu":"null","Loại: "+n.maLoaiCongTrinh),!t||!t.type||!t.coordinates)return console.error("Dữ liệu GeoJSON kh\xf4ng hợp lệ cho đoạn đ\xea bối: ".concat(n.tenDoan||n.id)),null;return t.properties||(t.properties={}),t.properties={...t.properties,id:n.id,tenDoan:n.tenDoan,viTriTu:n.viTriTu,viTriDen:n.viTriDen,chieuDai:n.chieuDai,capDe:n.capDe,maLoaiCongTrinh:n.maLoaiCongTrinh},t}catch(t){return console.error("Lỗi khi xử l\xfd dữ liệu đoạn đ\xea bối ".concat(n.tenDoan||n.id,":"),t),null}}).filter(n=>null!==n);return console.log("DeBoiLayerMap - Số đoạn đ\xea bối hợp lệ để vẽ:",e.length),{type:"FeatureCollection",features:e}},[t]);return e?(0,r.jsxs)(a.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:[(0,r.jsx)(f.Z,{}),(0,r.jsx)(s.Z,{variant:"body1",sx:{ml:2},children:"Đang tải bản đồ..."})]}):d&&0!==d.features.length?(0,r.jsx)(a.Z,{sx:{height:"100%",width:"100%"},children:(0,r.jsxs)(h,{boundaryFile:"/geojson/hye.geojson",config:{mapCenter:[20.65,106.3],mapZoom:10,maxBounds:[[20,105.8],[21.2,106.85]]},loading:e,children:[d&&(0,r.jsx)(l.Q,{data:d,style:n=>{let t=(n.properties||{}).id,e=3,r=.8,u=.4;return o&&t===o&&(e=5,r=1,u=.6),{color:"#efb916",weight:e,opacity:r,fillOpacity:u}},onEachFeature:(n,t)=>{if(n.properties){let{id:e,tenDoan:r,viTriTu:u,viTriDen:c,chieuDai:l,capDe:a}=n.properties;t.bindTooltip("<div>\n          <b>".concat(r||"Đoạn đ\xea bối","</b><br/>\n          Km: ").concat(u," - ").concat(c,"<br/>\n          Chiều d\xe0i: ").concat(l," km<br/>\n          Cấp đ\xea: ").concat(a||"Chưa x\xe1c định","\n        </div>"),{sticky:!0}),t.on({click:()=>{i&&e&&i(e)}}),o&&e===o&&setTimeout(()=>{try{let n=t._map;n&&n.fitBounds(t.getBounds(),{padding:[50,50]})}catch(n){console.error("Lỗi khi fit bounds:",n)}},300)}}}),d&&o&&(0,r.jsx)(n=>{let{selectedId:t,geoJsonData:e}=n,r=(0,c.Sx)(),o=(0,u.useRef)(null);return(0,u.useEffect)(()=>{if(t&&e){let n=e.features.find(n=>n.properties&&n.properties.id===t);if(n)try{o.current?(o.current.clearLayers(),o.current.addData(n)):o.current=p().geoJSON(n);let t=o.current.getBounds();r.fitBounds(t,{padding:[50,50]})}catch(n){console.error("Lỗi khi zoom đến đoạn đ\xea:",n)}}},[t,e,r]),null},{selectedId:o,geoJsonData:d})]})}):(0,r.jsx)(a.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,r.jsx)(s.Z,{variant:"body1",children:"Kh\xf4ng c\xf3 dữ liệu đoạn đ\xea bối để hiển thị"})})}},66389:function(n,t,e){e.d(t,{d:function(){return u}});var r=e(67294);function u(n,t){let e=(0,r.useRef)(t);(0,r.useEffect)(function(){t!==e.current&&null!=n.attributionControl&&(null!=e.current&&n.attributionControl.removeAttribution(e.current),null!=t&&n.attributionControl.addAttribution(t)),e.current=t},[n,t])}},99534:function(n,t,e){e.d(t,{G5:function(){return l},LE:function(){return c},RA:function(){return i}});var r=e(67294),u=e(73935),o=e(1410);function i(n){return(0,r.forwardRef)(function(t,e){let{instance:u,context:i}=n(t).current;return(0,r.useImperativeHandle)(e,()=>u),null==t.children?null:r.createElement(o.UO,{value:i},t.children)})}function c(n){return(0,r.forwardRef)(function(t,e){let[o,i]=(0,r.useState)(!1),{instance:c}=n(t,i).current;(0,r.useImperativeHandle)(e,()=>c),(0,r.useEffect)(function(){o&&c.update()},[c,o,t.children]);let l=c._contentNode;return l?(0,u.createPortal)(t.children,l):null})}function l(n){return(0,r.forwardRef)(function(t,e){let{instance:u}=n(t).current;return(0,r.useImperativeHandle)(e,()=>u),null})}},1410:function(n,t,e){e.d(t,{Hb:function(){return o},U1:function(){return c},UO:function(){return l},cV:function(){return u},mE:function(){return a},sj:function(){return i}});var r=e(67294);let u=1;function o(n){return Object.freeze({__version:u,map:n})}function i(n,t){return Object.freeze({...n,...t})}let c=(0,r.createContext)(null),l=c.Provider;function a(){let n=(0,r.useContext)(c);if(null==n)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return n}},77418:function(n,t,e){e.d(t,{y:function(){return o}});var r=e(67294),u=e(1410);function o(n){return function(t){let e=(0,u.mE)(),o=n(t,e),{instance:i}=o.current,c=(0,r.useRef)(t.position),{position:l}=t;return(0,r.useEffect)(function(){return i.addTo(e.map),function(){i.remove()}},[e.map,i]),(0,r.useEffect)(function(){null!=l&&l!==c.current&&(i.setPosition(l),c.current=l)},[i,l]),o}}},93461:function(n,t,e){e.d(t,{W:function(){return c}});var r=e(66389),u=e(1410),o=e(60620),i=e(81802);function c(n,t){return function(e,c){let l=(0,u.mE)(),a=n((0,i.q)(e,l),l);return(0,r.d)(l.map,e.attribution),(0,o.t)(a.current,e.eventHandlers),t(a.current,l,e,c),a}}},27999:function(n,t,e){e.d(t,{I:function(){return o},O:function(){return u}});var r=e(67294);function u(n,t,e){return Object.freeze({instance:n,context:t,container:e})}function o(n,t){return null==t?function(t,e){let u=(0,r.useRef)();return u.current||(u.current=n(t,e)),u}:function(e,u){let o=(0,r.useRef)();o.current||(o.current=n(e,u));let i=(0,r.useRef)(e),{instance:c}=o.current;return(0,r.useEffect)(function(){i.current!==e&&(t(c,e,i.current),i.current=e)},[c,e,u]),o}}},60620:function(n,t,e){e.d(t,{t:function(){return u}});var r=e(67294);function u(n,t){let e=(0,r.useRef)();(0,r.useEffect)(function(){return null!=t&&n.instance.on(t),e.current=t,function(){null!=e.current&&n.instance.off(e.current),e.current=null}},[n,t])}},74579:function(n,t,e){e.d(t,{Au:function(){return d},Lf:function(){return p},SO:function(){return s},dW:function(){return f},vm:function(){return a}});var r=e(99534),u=e(77418),o=e(27999),i=e(83655),c=e(93461),l=e(78840);function a(n){let t=(0,o.I)(function(t,e){return(0,o.O)(n(t),e)}),e=(0,u.y)(t);return(0,r.G5)(e)}function f(n,t){let e=(0,o.I)(n,t),u=(0,i.u)(e);return(0,r.RA)(u)}function s(n,t){let e=(0,o.I)(n),u=(0,c.W)(e,t);return(0,r.LE)(u)}function d(n,t){let e=(0,o.I)(n,t),u=(0,l.n)(e);return(0,r.RA)(u)}function p(n,t){let e=(0,o.I)(n,t),u=(0,i.u)(e);return(0,r.G5)(u)}},83655:function(n,t,e){e.d(t,{g:function(){return l},u:function(){return a}});var r=e(67294),u=e(66389),o=e(1410),i=e(60620),c=e(81802);function l(n,t){(0,r.useEffect)(function(){return(t.layerContainer??t.map).addLayer(n.instance),function(){t.layerContainer?.removeLayer(n.instance),t.map.removeLayer(n.instance)}},[t,n])}function a(n){return function(t){let e=(0,o.mE)(),r=n((0,c.q)(t,e),e);return(0,u.d)(e.map,t.attribution),(0,i.t)(r.current,t.eventHandlers),l(r.current,e),r}}},81802:function(n,t,e){e.d(t,{q:function(){return r}});function r(n,t){let e=n.pane??t.pane;return e?{...n,pane:e}:n}},78840:function(n,t,e){e.d(t,{_:function(){return l},n:function(){return a}});var r=e(67294),u=e(1410),o=e(60620),i=e(83655),c=e(81802);function l(n,t){let e=(0,r.useRef)();(0,r.useEffect)(function(){if(t.pathOptions!==e.current){let r=t.pathOptions??{};n.instance.setStyle(r),e.current=r}},[n,t])}function a(n){return function(t){let e=(0,u.mE)(),r=n((0,c.q)(t,e),e);return(0,o.t)(r.current,t.eventHandlers),(0,i.g)(r.current,e),l(r.current,t),r}}},84867:function(n,t,e){e.d(t,{Q:function(){return c}});var r=e(74579),u=e(27999),o=e(1410),i=e(45243);let c=(0,r.Au)(function({data:n,...t},e){let r=new i.GeoJSON(n,t);return(0,u.O)(r,(0,o.sj)(e,{overlayContainer:r}))},function(n,t,e){t.style!==e.style&&(null==t.style?n.resetStyle():n.setStyle(t.style))})},39153:function(n,t,e){e.d(t,{Sx:function(){return o},zV:function(){return i}});var r=e(1410),u=e(67294);function o(){return(0,r.mE)().map}function i(n){let t=o();return(0,u.useEffect)(function(){return t.on(n),function(){t.off(n)}},[t,n]),t}}}]);